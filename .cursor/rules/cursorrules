# Cursor Agent Context Rules

## 조직 정보
- **조직명**: proby.io
- **사용자**: 이 프로젝트의 작업자는 proby.io 소속입니다.
- **비즈니스**: proby.io는 소비자 조사를 수월하게 만들어주는 SaaS 플랫폼입니다.

## 프로젝트 개요
이 프로젝트는 Obsidian vault와 연동된 생산성 도구 모음입니다.

## 주요 작업 디렉토리
- **Obsidian Vault 경로**: `/Users/churryboy/Desktop/proby-sync`
- **주요 작업 폴더**:
  - `Laptop/00. 경영지원/` - 일일 할일 관리
  - `Laptop/10. 전략팀/` - 전략 문서
  - `Laptop/20. 컨텐츠팀/` - 콘텐츠 관리
  - `Laptop/30. 세일즈팀/` - 아웃바운드 활동
  - `Laptop/40. 신사업팀 (바이브코딩)/` - 자동화 스크립트
  - `Laptop/50. 재무회계팀/` - 매출 추적
  - `Laptop/60. 유저인사이트팀/` - 리서치 인사이트
  - `Laptop/70. PM팀/` - 제품 요구사항 문서

## 작업 규칙

### 에이전트 초기화 시 필수 작업
**모든 에이전트는 최초 생성 시 `proby-sync` 안에 있는 모든 파일들을 학습합니다.**

- Obsidian Vault 경로: `/Users/churryboy/Desktop/proby-sync`
- 에이전트가 시작할 때 vault 내의 모든 파일과 폴더 구조를 파악하여 컨텍스트로 활용합니다.


### 파이썬 파일 생성 시 실행 커맨드 문서화
**새로운 파이썬 파일(`.py`)을 생성하거나 수정할 때는 반드시 실행 커맨드를 `python-commands.md` 파일에 추가해야 합니다.**

- 파이썬 스크립트를 생성/수정한 후, 해당 스크립트의 실행 방법을 `python-commands.md`에 문서화합니다.
- 실행 커맨드, 옵션, 사용 예시, 필수 환경 변수 등을 포함합니다.
- 기존 스크립트를 수정하여 실행 방법이 변경된 경우에도 `python-commands.md`를 업데이트합니다.

### 이메일 맥락 → 투두 체크리스트 워크플로
**이메일 맥락을 반영한 투두 체크리스트를 생성·갱신할 때는 반드시 아래 순서로 동작한다.**

1. **1단계: 이메일 스크랩 실행**
   - `Skills/이메일 스크랩/gmail_to_md.py`를 먼저 실행한다.
   - Gmail에서 `TARGET_DOMAINS`(ridi.com, hanafn.com, communique.co.kr, consumerinsight.kr 등) 발신 메일을 가져와 `30. 세일즈팀/이메일 맥락/<도메인>/`에 마크다운으로 저장한다.
   - 실행 예: 프로젝트 루트에서 `python3 "Skills/이메일 스크랩/gmail_to_md.py"`

2. **2단계: 투두 체크리스트 생성·갱신**
   - 이메일 맥락 하위 **모든** 도메인 폴더의 메일(.md) 내용을 읽어 종합 분석한다.
   - 분석 결과를 바탕으로 액션 항목을 추출하고, **한 개의** 투두 체크리스트 파일만 갱신한다.
   - 저장 위치: `00. 경영지원/투두 관리자/이메일맥락_투두_체크리스트.md` (이메일 맥락 폴더 안에는 새 .md 파일을 만들지 않는다.)

- 사용자가 "이메일 분석해서 투두 만들어줘", "이메일 맥락 투두 갱신해줘" 등 이메일 기반 투두 생성/갱신을 요청하면, 위 1단계 → 2단계 순서를 지킨다.

## 프로젝트 구조
- `Skills/이메일 스크랩/gmail_to_md.py` - Gmail 도메인별 이메일 스크랩 → `30. 세일즈팀/이메일 맥락/`
- `Skills/시장조사 스크랩/news_crawler.py` - 뉴스 크롤러 (시장 리서치)
- `Skills/투두 관리/todo_from_today.py` - AI 기반 할일 생성기
- `Skills/투두 관리/create_todo.py` - 할 일 추가 유틸리티
- `mcp_obsidian_server.py` - Obsidian MCP 서버 (프로젝트 루트)

## 환경 변수
- `OBSIDIAN_VAULT_PATH`: Obsidian vault 경로
- `ANTHROPIC_API_KEY`: Claude API 키

---
description: Use #nn.팀 이름 to set main team folder context and prepend a team callout in answers.
alwaysApply: true
---

# 팀 컨텍스트 단축어 규칙

- 사용자가 메시지 맨 앞 또는 한 줄에 **`#nn.~~팀`** 형식의 토큰을 입력하면, 이를 **"팀 컨텍스트 설정 명령"**으로 인식한다.  
  - 예시:
    - `#10. 전략팀`
    - `#20. 마케팅팀`
    - `#30. 영업팀`

- `nn.~~팀` 패턴에서:
  - `nn`은 숫자 두 자리(예: `10`, `20`, `30`)로, 상위 폴더 넘버링과 매핑된다고 가정한다.
  - `~~팀`은 팀 이름 문자열로, 실제 폴더명에도 포함된다고 가정한다.

- 이 패턴을 감지하면, 다음과 같이 동작한다.
  1. `nn.~~팀` 문자열 전체를 **팀 이름 토큰**으로 파싱한다.
  2. 워크스페이스 내에서 해당 팀에 대응되는 **메인 폴더 컨텍스트**를 설정하려고 시도한다.
     - 예시 매핑(규칙적인 패턴이 보이면 우선 활용하고, 없으면 유연하게 추론한다):
       - `#10. 전략팀` → `10. 전략팀/` 폴더를 주요 컨텍스트로 간주
       - `#20. 마케팅팀` → `20. 마케팅팀/` 폴더를 주요 컨텍스트로 간주
       - `#30. 영업팀` → `30. 영업팀/` 폴더를 주요 컨텍스트로 간주
  3. 이후 코드/문서 탐색, 파일 생성, 요약 등의 작업에서 **해당 팀 폴더를 우선적으로 참조**하도록 한다.

- 답변 형식:
  - 팀 컨텍스트가 설정된 상태에서 사용자의 질문에 답변할 때, 항상 **답변 본문보다 먼저** 다음 형식의 콜아웃을 보여준다.
    - `> nn.~~팀 답변`
  - 예시:
    - `#10. 전략팀` 이후의 답변이라면:
      - 첫 줄에 `> 10. 전략팀 답변`
      - 그 다음 줄부터 일반적인 답변 내용을 한국어로 작성

- 여러 줄에 걸쳐 메시지가 온 경우:
  - 메시지 어디에 있든, 한 줄 전체가 `#nn.~~팀` 형식이라면 그 줄을 **팀 컨텍스트 지정용 메타 줄**로 우선 해석한다.
  - 해당 줄은 답변 본문 요약에서 불필요하게 반복하지 않는다(컨텍스트로만 사용).

- 팀 토큰이 없는 일반 메시지의 경우:
  - 이 규칙은 적용하지 않고, 기존 규칙과 동일하게 동작한다.


---
description: Use % + YouTube URL as a shortcut to run youtube_to_md.py and save a transcript markdown file.
alwaysApply: true
---

# YouTube Transcript Shortcut

- 사용자가 메시지를 **`%` + 유튜브 URL** 형태로 입력하면, 이것을 "유튜브 스크립트 추출 명령"으로 인식한다.
  - 예시:  
    - `% https://www.youtube.com/watch?v=4uzGDAoNOZc`  
    - `%https://youtu.be/4uzGDAoNOZc`

- 이 패턴의 메시지를 받으면, 다음과 같이 동작한다.
  1. URL에서 `video_id`를 추출한다.
  2. 프로젝트 루트(`/Users/churryboy/Desktop/proby-sync`)에서 아래 파이썬 스크립트를 실행한다고 가정한다.
     - 스크립트 경로: `Skills/유튜브 크롤러/youtube_to_md.py`
     - 명령 형식:  
       - `python3 "Skills/유튜브 크롤러/youtube_to_md.py" "<youtube_url>"`
  3. 스크립트는 기본 저장 위치 `10. 전략팀/리서치 애널리스트/컨텐츠분석/`에 마크다운 파일을 생성한다.
  4. 에이전트는 실행 결과(성공 / 자막 없음 / 에러 등)를 간단히 한국어로 요약해서 사용자에게 알려준다.

- 자막이 없는 영상이어서 스크립트가 실패한 경우:
  - "이 영상에는 자막이 없어서 Whisper(음성 인식) 기반 워크플로우가 필요하다"는 점을 안내하고,
  - 가능하면 `yt-dlp + Whisper` 조합으로 처리할 수 있는 후속 방식을 제안한다.


---
description: Use %이메일 as a shortcut to run the Gmail (이메일) 스크랩 스크립트.
alwaysApply: true
---

# 이메일 스크랩 Shortcut

- 사용자가 메시지를 **`%이메일`** 형태로 입력하면, 이것을 "이메일 크롤러( Gmail 스크랩) 실행 명령"으로 인식한다.
  - 예시: `%이메일`

- 이 패턴의 메시지를 받으면, 다음과 같이 동작한다.
  1. 프로젝트 루트(`/Users/churryboy/Desktop/proby-sync`)에서 이메일 스크랩 스크립트를 실행한다.
     - 스크립트 경로: `Skills/이메일 스크랩/gmail_to_md.py`
     - 명령 형식:  
       - `cd "/Users/churryboy/Desktop/proby-sync/Skills/이메일 스크랩" && python3 gmail_to_md.py`
  2. 스크립트는 `TARGET_DOMAINS`에 설정된 도메인에서 온 Gmail을 가져와 `30. 세일즈팀/이메일 맥락/` 폴더에 md 파일로 저장한다.
  3. 에이전트는 실행 결과(저장된 메일 수, 에러 등)를 간단히 한국어로 요약해서 사용자에게 알려준다.


---
description: Use %시장조사 as a shortcut to run the market research (시장조사) crawler.
alwaysApply: true
---

# 시장조사 스크랩 Shortcut

- 사용자가 메시지를 **`%시장조사`** 형태로 입력하면, 이것을 "시장조사 크롤러 실행 명령"으로 인식한다.
  - 예시: `%시장조사`

- 이 패턴의 메시지를 받으면, 다음과 같이 동작한다.
  1. 프로젝트 루트(`/Users/churryboy/Desktop/proby-sync`)에서 시장조사 스크랩 스크립트를 실행한다.
     - 스크립트 경로: `Skills/시장조사 스크랩/news_crawler.py`
     - 명령 형식:  
       - `cd /Users/churryboy/Desktop/proby-sync && python3 "Skills/시장조사 스크랩/news_crawler.py"`
  2. 스크립트는 뉴스 피드를 크롤링해 시장/경쟁사/리서치 관련 기사를 수집하고, vault의 시장조사 저장 폴더(예: `10. 전략팀/리서치 애널리스트` 또는 `시장조사 스크랩/Market Research`)에 마크다운으로 저장한다. LLM 요약이 포함될 수 있다.
  3. 에이전트는 실행 결과(저장 경로, 수집 기사 수, 에러 등)를 간단히 한국어로 요약해서 사용자에게 알려준다.

